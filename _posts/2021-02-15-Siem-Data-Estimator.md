---
title: Estimate your SIEM storage
published: true
---

[Back to main list](./)

**Introduction**

First step when implement a security monitoring solution is to collect data - without data is like been blind .. right?
Therefore, it is becoming increasingly necessary to have the ability to estimate log generation for one’s environment, to estimate the amount of storage required for log data, and to estimate the cost of various solutions given their licensing model.
However, I’d like to disclaim that there is no one size fits all for estimating log generation. There are too many factors that impact the amount of data generated, including, but not limited to, network complexity, number and type of devices generating logs, the load on each device, logging and severity policies, type of operating system running on devices, etc.
Log Management (LM) is a term used for the process dealing with large volumes of computer generated log messages. LM deals with log collection, centralization/aggregation, retention, search and analysis, and presentation (reporting).
SIEM, also known as security information management (SIM) or security event management (SEM), in terms of security does it all in one: performing the data aggregation, but also including correlation, alerting and presentation in a graphical dashboard for the purpose of compliance and retention.
Know how much data to be collect will help you scope or determine:
* An appropriate LM or SIEM – since many LMs or SIEMs are rated or licensed based on amount of logged data.
* Your online and offline storage requirements – if you have compliance requirements then you will have some type of retention policy. Your retention policy along with the amount of log data generated will determine your storage requirement.
* Your daily storage management – Storage costs money and you don’t want to spend more than you have to, however, you do not want to run out of storage either. Understanding your data collection will better allow you to manage and plan your log data storage needs.

**Approach**

To calculate, or at least to attempt it, we start with the basic unit component - Event per Seconds (EPS). EPS is the number of log or system events that are generated by a device every second. It is critical that you have an accurate estimate of your EPS or else you risk over sizing (paying too much) or under sizing (losing data) your solution.
There are 2 types of EPS, normal NEx and peak PEx. PEx is extremely important, although is very much a theoretical, albeit impractical measurement - i.e a worm alike may fire off thousands of EPS from several network devices in multiple subnets, hence it can quickly spiral out of control.
Now that you have an EPS count, next you need to estimate how much data will be generated per seconds and per day, and apply the results to estimate how much storage you’ll require for your data retention.

_Formulas_

>_GB/seconds (GBsec) = (EPS * event-bytes)/(1024)^3 = (EPS * event-bytes)/1073741824_
>
>_GB/day (GBday)= GBsec * 86400_
>
>_GB Storage (GBstg) = GBday * Retention_Days_

An average log message size should be decided in order to know how much storage is going to be needed every day. Log sources generate logs starting from 200 bytes range on network and infrastructure devices to 10 kilobytes or more on application and database side.  Syslog standard (RFC 5424) sets the maximum size of the content field of a log message to 2 kilobytes. In light of this information, it is wise and advisable to assume a raw log message size as 500 bytes.
However, log management solutions typically normalizes the data to make them understandable and meaningful. It can increase the log size about 90% to 100%, hence we can assume that the original size could be double, so GBdayNormalized = GBday * 2. Also, often a data compression is used to reduce log data size. It is safe to say that an average ratio  of 8:1 compression could be used, hence you can also divide GBdayNormalized  by 8 - GBday = GBdayNormalized/8. 

Final formula for GBday would be:

>_GBday = (GBsec * 86400)/4_


The last important point is the retention period when you plan your storage investments for future. 2 factors are decisive in the definition of retention period, Compliance Requirements and Security Requirements. Compliance Requirements only concern Log Management systems, and there is not much to decide really, whatever the legislation obliges, you have to configure. A Dwell Time, the median number of days attackers were present on a victim network before they were discovered is currently is about 50 to 100 days. Retention period for security alert creation, monitoring, trending and forensics should be at least as much as the Dwell Time.


**Conclusion**

In conclusion there is no simple “rule-of-thumb” approach to estimating the amount of log data that can be generated by an organization. There are simply too many factors that have an impact. When scoping a SIEM or LM solution, the most accurate method to determine log data generation is to take a sample over a given time period using a simple syslog server tool, such as Kiwi Syslog Server, that can tell you exactly how much data his being generated.

![siem_eps.png](/assets/siem_eps.png)
